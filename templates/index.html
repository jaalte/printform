<!DOCTYPE html>
<html>
<head>
    <title>Plant Tag Printer</title>
	<style>
		#label-image {
			max-width: 500px
		}
	</style>
</head>
<body>
    <h1>Plant Tag Printer</h1>
    <form id="label-form" method="POST">
        <label for="main_text">Main text:</label>
        <input type="text" id="main_text" name="main_text" required><br><br>
		<label for="cultivar">Cultivar:</label>
        <input type="text" id="cultivar" name="cultivar" required><br><br>
        <label for="subtext">Subtext:</label>
        <input type="text" id="subtext" name="subtext" required><br><br>
        <input type="submit" value="Generate Label">
    </form>
	<img id="label-image" src="" alt="Generated label" style="display: none;">

	<script>
	  document.getElementById('label-form').addEventListener('submit', function (event) {
		event.preventDefault();

		const formData = new FormData(event.target);

		fetch('/generate_label', {
		  method: 'POST',
		  body: formData,
		})
		  .then((response) => response.json())
		  .then((data) => {
			const labelImage = document.getElementById('label-image');
			labelImage.src = data.image_path;
			labelImage.style.display = 'block';
		  });
	  });
	</script>

	
	<!-- Add this script at the bottom of the index.html file, before the closing </body> tag -->
	<script>
	  document.getElementById('label-form').addEventListener('submit', function (event) {
		event.preventDefault();

		var xhr = new XMLHttpRequest();
		xhr.open('POST', '/generate_label', true);
		xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
		xhr.onreadystatechange = function () {
		  if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
			var response = JSON.parse(this.responseText);
			document.getElementById('generated-label').src = response.image_path;
		  }
		};

		var formData = new FormData(event.target);
		var encodedData = new URLSearchParams(formData).toString();
		xhr.send(encodedData);
	  });
	</script>
</body>
</html>

